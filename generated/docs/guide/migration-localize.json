{
  "id": "guide/migration-localize",
  "title": "$localize Global Import Migration",
  "contents": "\n\n\n<div class=\"github-links\">\n  <a href=\"https://github.com/angular/angular-cn/edit/aio/aio/content/guide/migration-localize.md?message=docs%3A%20请简述你的修改...\" aria-label=\"提供编辑建议\" title=\"提供编辑建议\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n</div>\n\n\n<div class=\"content\">\n  <h1 id=\"localize-global-import-migration\" translation-result=\"on\"><code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> 全局导入的迁移<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-localize#localize-global-import-migration\"><i class=\"material-icons\">link</i></a></h1><h1 translation-origin=\"off\" id=\"localize-global-import-migration\"><code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> Global Import Migration<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-localize#localize-global-import-migration\"><i class=\"material-icons\">link</i></a></h1>\n\n<h2 id=\"what-does-this-schematic-do\" translation-result=\"on\">这个原理图做了什么？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-localize#what-does-this-schematic-do\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"what-does-this-schematic-do\">What does this schematic do?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-localize#what-does-this-schematic-do\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">如果你正在使用 i18n，这个原理图会为 <code>@angular/localize</code> 添加一个导入 <code>polyfills.ts</code> 的语句，就像这样：</p><p translation-origin=\"off\">If you're using i18n, this schematic adds an import statement for <code>@angular/localize</code> to <code>polyfills.ts</code> that will look something like this:</p>\n\n<code-example format=\"typescript\" language=\"typescript\">\n\n/******************************************************************\n * Load `$localize` - used if i18n tags appear in Angular templates.\n */\nimport '@angular/localize/init';\n\n</code-example>\n<p translation-result=\"on\">它还会在应用的 <code>package.json</code> 中列出 <code>@angular/localize</code> 作为依赖，以确保找到导入。</p><p translation-origin=\"off\">It also lists <code>@angular/localize</code> as a dependency in your app's <code>package.json</code> to ensure the import is found.</p>\n\n<code-example format=\"json\" language=\"json\">\n\n\"devDependencies\": {\n  …\n  \"@angular/localize\": \"…\",\n  …\n}\n\n</code-example>\n<p translation-result=\"on\"><code>@angular/localize</code> 是一个新的包，它在 Ivy 应用中支持信息的 i18n。该包需要一个全局的 <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> 符号才能存在。该符号是通过导入 <code>@angular/localize/init</code> 模块来加载的，该模块的副作用是将其附加到全局作用域。</p><p translation-origin=\"off\"><code>@angular/localize</code> is a new package that supports i18n of messages in Ivy applications.\nThis package requires a global <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> symbol to exist.\nThe symbol is loaded by importing the <code>@angular/localize/init</code> module, which has the side-effect of attaching it to the global scope.</p>\n\n<h2 id=\"why-is-this-migration-necessary\" translation-result=\"on\">为何这次迁移必不可少？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-localize#why-is-this-migration-necessary\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"why-is-this-migration-necessary\">Why is this migration necessary?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-localize#why-is-this-migration-necessary\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">在 Angular 第 9 版之前，Angular 的国际化（i18n）系统会把已翻译的消息内联到编译输出中，作为模板编译的一部分。这种方法要求为每个目标本地环境运行一次模板编译器，这通常会导致生产构建时间变慢。</p><p translation-origin=\"off\">Prior to Angular version 9, Angular's internationalization (i18n) system inlined translated messages into the compiled output as part of this template compilation.\nThis approach required running the template compiler once per target locale, often leading to slow production build times.</p>\n\n<p translation-result=\"on\">在新的 i18n 系统中，Angular 编译器使用全局 <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> 处理函数在已编译的代码中标记 i18n 消息。然后这些翻译的内联工作会作为每种本地环境的后编译步骤。由于不需要为每个本地环境重复构建应用，所以这会让这个过程更快。</p><p translation-origin=\"off\">In the new i18n system, the Angular compiler tags i18n messages in the compiled code with a global <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> handler.\nThe inlining of translations then occurs as a post-compilation step for each locale.\nBecause the application does not need to be built again for each locale, this makes the process much faster.</p>\n\n<p translation-result=\"on\">编译后的内联步骤是可选的 - 比如在开发过程中，或者运行期内联时。因此，这个 <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> 在运行时必须在全局范围内可用。为了让全局范围内的 <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> 可用，每个应用程序现在都必须导入 <code>@angular/localize/init</code> 模块。这就是把 <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> 的一个最小实现附加到全局范围带来的副作用。</p><p translation-origin=\"off\">The post-compilation inlining step is optional —for example during development or if the translations will be inlined at runtime.\nTherefore this global <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> must be available on the global scope at runtime.\nTo make <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> available on the global scope, each application must now import the <code>@angular/localize/init</code> module.\nThis has the side-effect of attaching a minimal implementation of <code>&#x26;dollar;localize</code> to the global scope.</p>\n\n<p translation-result=\"on\">如果缺少这个导入，你会看到如下错误信息：</p><p translation-origin=\"off\">If this import is missing, you will see an error message like this:</p>\n\n<code-example format=\"output\" hidecopy=\"\" language=\"shell\">\n\nError: It looks like your application or one of its dependencies is using i18n.\nAngular 9 introduced a global `$localize()` function that needs to be loaded.\nPlease run `ng add @angular/localize` from the Angular CLI.\n(For non-CLI projects, add `import '@angular/localize/init';` to your polyfills.ts file)\n\n</code-example>\n<p translation-result=\"on\">如果你的应用使用的是 Angular 的 i18n API，此原理图会自动为你添加 <code>@angular/localize/init</code> 的导入。</p><p translation-origin=\"off\">This schematic automatically adds the <code>@angular/localize/init</code> import for you if your app uses Angular's i18n APIs.</p>\n\n<h2 id=\"why-is-my-tslint-failing\" translation-result=\"on\">为什么我的 tslint 失败了？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-localize#why-is-my-tslint-failing\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"why-is-my-tslint-failing\">Why is my tslint failing?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-localize#why-is-my-tslint-failing\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\"><code>@angular/localize/init</code> 的导入可能会导致 <code>no-import-side-effect</code> 的 tslint 错误，因为它会添加全局上下文（也就是副作用）。要修复此错误，请在 <code>tslint.config</code> 添加如下 <code>tslint.config</code> ：</p><p translation-origin=\"off\">The import of <code>@angular/localize/init</code> may cause a tslint error for <code>no-import-side-effect</code> because it adds to the global context (that is, a side effect).\nTo fix this error, add the following to your <code>tslint.config</code>:</p>\n\n<code-example format=\"json\" language=\"json\">\n\n\"no-import-side-effect\": [\n  true,\n  {\n    \"ignore-module\": \"(core-js/.*|zone\\\\.js/.*|@angular/localize/init)$\"\n  }\n]\n\n</code-example>\n<h2 id=\"do-i-need-to-change-how-i-write-i18n-in-my-angular-templates\" translation-result=\"on\">我是否需要改变在 Angular 模板中编写 i18n 的方式？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-localize#do-i-need-to-change-how-i-write-i18n-in-my-angular-templates\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"do-i-need-to-change-how-i-write-i18n-in-my-angular-templates\">Do I need to change how I write i18n in my Angular templates?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-localize#do-i-need-to-change-how-i-write-i18n-in-my-angular-templates\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">i18n 的模板语法没有改变，所以你仍要像以前一样使用 <code>i18n</code> 属性。</p><p translation-origin=\"off\">The template syntax for i18n has not changed, so you will still want to use the <code>i18n</code> attribute as you did before.</p>\n\n<!-- links -->\n<!-- external links -->\n<!-- end links -->\n\n  <div class=\"reviewed\">最后复查时间： 2/28/2022</div>\n</div>\n\n\n<!-- links to this doc:\n-->\n<!-- links from this doc:\n - api/localize/init/$localize\n - guide/migration-localize#do-i-need-to-change-how-i-write-i18n-in-my-angular-templates\n - guide/migration-localize#localize-global-import-migration\n - guide/migration-localize#what-does-this-schematic-do\n - guide/migration-localize#why-is-my-tslint-failing\n - guide/migration-localize#why-is-this-migration-necessary\n - https://github.com/angular/angular-cn/edit/aio/aio/content/guide/migration-localize.md?message=docs%3A%20请简述你的修改...\n-->"
}