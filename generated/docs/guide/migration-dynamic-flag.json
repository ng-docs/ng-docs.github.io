{
  "id": "guide/migration-dynamic-flag",
  "title": "Dynamic queries flag migration",
  "contents": "\n\n\n<div class=\"github-links\">\n  <a href=\"https://github.com/angular/angular-cn/edit/aio/aio/content/guide/migration-dynamic-flag.md?message=docs%3A%20请简述你的修改...\" aria-label=\"提供编辑建议\" title=\"提供编辑建议\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n</div>\n\n\n<div class=\"content\">\n  <h1 id=\"dynamic-queries-flag-migration\" translation-result=\"on\">动态查询标志的迁移<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#dynamic-queries-flag-migration\"><i class=\"material-icons\">link</i></a></h1><h1 translation-origin=\"off\" id=\"dynamic-queries-flag-migration\">Dynamic queries flag migration<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#dynamic-queries-flag-migration\"><i class=\"material-icons\">link</i></a></h1>\n\n<h2 id=\"what-does-this-migration-do\" translation-result=\"on\">这种迁移是做什么的？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#what-does-this-migration-do\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"what-does-this-migration-do\">What does this migration do?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#what-does-this-migration-do\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">在 Angular 的 8 版本中，升级原理图为所有 <code>@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>()</code> 和 <code>@<a href=\"api/core/ContentChild\" class=\"code-anchor\">ContentChild</a>()</code> 查询都添加了 <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> 标志。这是改变默认行为的第一步。在版本 9 中，默认值变成了 <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: false</code>，该标志变为可选的。</p><p translation-origin=\"off\">In Angular version 8, a schematic added <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> flags to all <code>@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>()</code> and <code>@<a href=\"api/core/ContentChild\" class=\"code-anchor\">ContentChild</a>()</code> queries.\nThis was the first step towards changing the default behavior.\nWith version 9, the default value changes to <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: false</code> and the flag becomes optional.</p>\n\n<p translation-result=\"on\">该原理图扫描了编译中的类，并为每个类检查这些成员是否有 <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> 标志设置为 <code>false</code> 的 <code>@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>()</code> 或 <code>@<a href=\"api/core/ContentChild\" class=\"code-anchor\">ContentChild</a>()</code> 查询。如果是这样，该原理图会移除该标志，因为它现在是默认值了。</p><p translation-origin=\"off\">This schematic scans classes in the compilation and for each class, checks if the members have a <code>@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>()</code> or <code>@<a href=\"api/core/ContentChild\" class=\"code-anchor\">ContentChild</a>()</code> query with the <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> flag set to <code>false</code>.\nIf so, the schematic removes the flag, as it now matches the default.</p>\n\n<p translation-result=\"on\"><strong>之前：</strong></p><p translation-origin=\"off\"><strong>Before:</strong></p>\n\n<code-example language=\"ts\">\n@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>('foo', {<a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: false}) foo: <a href=\"api/core/ElementRef\" class=\"code-anchor\">ElementRef</a>;\n\n@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>('bar', {<a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: true}) bar: <a href=\"api/core/ElementRef\" class=\"code-anchor\">ElementRef</a>;\n</code-example>\n<p translation-result=\"on\"><strong>之后：</strong></p><p translation-origin=\"off\"><strong>After:</strong></p>\n\n<code-example language=\"ts\">\n@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>('foo') foo: <a href=\"api/core/ElementRef\" class=\"code-anchor\">ElementRef</a>;\n\n// this <a href=\"api/animations/query\" class=\"code-anchor\">query</a> doesn't change because the <a href=\"api/upgrade/static\" class=\"code-anchor\">static</a> value is true\n@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>('bar', {<a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: true}) bar: <a href=\"api/core/ElementRef\" class=\"code-anchor\">ElementRef</a>;\n</code-example>\n<p translation-result=\"on\">请注意，<code>@<a href=\"api/core/ViewChildren\" class=\"code-anchor\">ViewChildren</a>()</code> 或 <code>@<a href=\"api/core/ContentChildren\" class=\"code-anchor\">ContentChildren</a>()</code> 查询中不支持该标志，因此该原理图不会检查这些属性。</p><p translation-origin=\"off\">Note that the flag is not supported in <code>@<a href=\"api/core/ViewChildren\" class=\"code-anchor\">ViewChildren</a>()</code> or <code>@<a href=\"api/core/ContentChildren\" class=\"code-anchor\">ContentChildren</a>()</code> queries, so the schematic will not check these properties.</p>\n\n<h2 id=\"why-is-this-migration-necessary\" translation-result=\"on\">为何这次迁移必不可少？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#why-is-this-migration-necessary\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"why-is-this-migration-necessary\">Why is this migration necessary?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#why-is-this-migration-necessary\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">这个原理图执行代码清理工作来移除与默认值相匹配的 <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> 标志，因为它们不再是必需的。从功能上讲，这种代码更改应该没有影响。</p><p translation-origin=\"off\">This schematic performs a code cleanup to remove <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> flags that match the default, as they are no longer necessary.\nFunctionally, the code change should be a noop.</p>\n\n<p translation-result=\"on\">在版本 9 之前，Angular 会根据模板的编写方式来自动判定查询应该是静态的还是动态的。然而，以这种方式处理模板会导致错误和意外行为（请参阅<a href=\"guide/static-query-migration#what-does-this-flag-mean\">静态查询迁移指南</a>中的更多内容）。所以，从版本 9 开始，Angular 默认使用动态查询（ <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: false</code> ），简化了查询过程。开发人员仍然可以把查询显式设置为 <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: true</code>。</p><p translation-origin=\"off\">Before version 9, Angular figured out the static or dynamic nature of a query automatically, based on how the template was written.\nLooking at templates in this way, however, caused buggy and surprising behavior (see more about that in the <a href=\"guide/static-query-migration#what-does-this-flag-mean\">Static Query Migration Guide</a>).\nAs of version 9, Angular uses dynamic queries (<code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: false</code>) by default, which simplifies queries.\nDevelopers can still explicitly set a query to <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: true</code> if necessary.</p>\n\n<div class=\"alert is-helpful\">\n<h3 id=\"what-is-the-difference-between-static-and-dynamic-queries\" translation-result=\"on\">静态查询和动态查询有什么区别？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#what-is-the-difference-between-static-and-dynamic-queries\"><i class=\"material-icons\">link</i></a></h3><h3 translation-origin=\"off\" id=\"what-is-the-difference-between-static-and-dynamic-queries\">What is the difference between static and dynamic queries?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#what-is-the-difference-between-static-and-dynamic-queries\"><i class=\"material-icons\">link</i></a></h3>\n\n<p translation-result=\"on\"><code>@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>()</code> 和 <code>@<a href=\"api/core/ContentChild\" class=\"code-anchor\">ContentChild</a>()</code> 查询的 <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> 选项决定了其查询结果何时可用。</p><p translation-origin=\"off\">The <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> option for <code>@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>()</code> and <code>@<a href=\"api/core/ContentChild\" class=\"code-anchor\">ContentChild</a>()</code> queries determines when the query results become available.</p>\n\n<p translation-result=\"on\">使用静态查询（ <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: true</code> ）时，视图刚刚被创建，还没有运行变更检测之前，此查询就会解析。但是，其结果永远不会更新，以反映对视图的更改，例如对 <code><a href=\"api/common/NgIf\" class=\"code-anchor\">ngIf</a></code> 和 <code><a href=\"api/common/NgForOf\" class=\"code-anchor\">ngFor</a></code> 块的更改。</p><p translation-origin=\"off\">With static queries (<code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: true</code>), the query resolves once the view has been created, but before change detection runs.\nThe result, though, will never be updated to reflect changes to your view, such as changes to <code><a href=\"api/common/NgIf\" class=\"code-anchor\">ngIf</a></code> and <code><a href=\"api/common/NgForOf\" class=\"code-anchor\">ngFor</a></code> blocks.</p>\n\n<p translation-result=\"on\">而使用动态查询（ <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: false</code> ）时，此查询会分别在 <code>ngAfterViewInit()</code> 或 <code>ngAfterContentInit()</code> 之后进行解析。此结果将随着对视图的更改而更新，例如对 <code><a href=\"api/common/NgIf\" class=\"code-anchor\">ngIf</a></code> 和 <code><a href=\"api/common/NgForOf\" class=\"code-anchor\">ngFor</a></code> 块的更改。</p><p translation-origin=\"off\">With dynamic queries (<code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a>: false</code>), the query resolves after either <code>ngAfterViewInit()</code> or <code>ngAfterContentInit()</code> for <code>@<a href=\"api/core/ViewChild\" class=\"code-anchor\">ViewChild</a>()</code> and <code>@<a href=\"api/core/ContentChild\" class=\"code-anchor\">ContentChild</a>()</code> respectively.\nThe result will be updated for changes to your view, such as changes to <code><a href=\"api/common/NgIf\" class=\"code-anchor\">ngIf</a></code> and <code><a href=\"api/common/NgForOf\" class=\"code-anchor\">ngFor</a></code> blocks.</p>\n\n<p translation-result=\"on\">要了解更多信息，请参阅<a href=\"guide/static-query-migration\">静态查询迁移指南</a>中的以下条目：</p><p translation-origin=\"off\">For more information, see the following entries in the\n<a href=\"guide/static-query-migration\">Static Query Migration Guide</a>:</p>\n\n<ul>\n<li>\n<p translation-result=\"on\"><a href=\"guide/static-query-migration#how-do-i-choose-which-static-flag-value-to-use-true-or-false\">如何选择使用哪个 <code>static</code> 标志值： <code>true</code> 还是 <code>false</code> ？</a></p><p translation-origin=\"off\"><a href=\"guide/static-query-migration#how-do-i-choose-which-static-flag-value-to-use-true-or-false\">How do I choose which <code>static</code> flag value to use: <code>true</code> or <code>false</code>?</a></p>\n\n</li>\n<li>\n<p translation-result=\"on\"><a href=\"guide/static-query-migration#is-there-a-case-where-i-should-use-static-true\">哪些情况下我应该使用 <code>{static: true}</code> ？</a></p><p translation-origin=\"off\"><a href=\"guide/static-query-migration#is-there-a-case-where-i-should-use-static-true\">Is there a case where I should use <code>{static: true}</code>?</a></p>\n\n</li>\n</ul>\n</div>\n<h2 id=\"what-does-this-mean-for-libraries\" translation-result=\"on\">这对库来说意味着什么？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#what-does-this-mean-for-libraries\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"what-does-this-mean-for-libraries\">What does this mean for libraries?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#what-does-this-mean-for-libraries\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">为了支持那些仍在运行版本 8 的应用，库中最安全的选项是保留 <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> 标志，以保持解析时序的一致性。</p><p translation-origin=\"off\">In order to support applications that are still running with version 8, the safest option for libraries is to retain the <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> flag to keep the resolution timing consistent.</p>\n\n<ul>\n<li>\n<p translation-result=\"on\"><em>库的版本为 9，应用的版本为 8：</em></p><p translation-origin=\"off\"><em>Libraries on version 9 with applications running version 8: </em></p>\n\n<p translation-result=\"on\">该原理图不会在库中运行。只要库从版本 8 开始就保留了 <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> 标志，就同样可以在 8 上运行。</p><p translation-origin=\"off\">The schematic won't run on libraries.\nAs long as libraries retain their <code><a href=\"api/upgrade/static\" class=\"code-anchor\">static</a></code> flags from version 8, they should work with apps on 8.</p>\n\n</li>\n<li>\n<p translation-result=\"on\"><em>应用的版本为 9，库的版本为 8：</em></p><p translation-origin=\"off\"><em>Libraries on version 8 with applications running version 9: </em></p>\n\n<p translation-result=\"on\">库中中会定义显式的标志。只要带有显式标志，其行为就不会改变。</p><p translation-origin=\"off\">Libraries will have explicit flags defined.\nThe behavior with explicit flags has not changed.</p>\n\n</li>\n</ul>\n<h3 id=\"what-about-applications-using-non-migrated-libraries\" translation-result=\"on\">那些使用未迁移库的应用呢？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#what-about-applications-using-non-migrated-libraries\"><i class=\"material-icons\">link</i></a></h3><h3 translation-origin=\"off\" id=\"what-about-applications-using-non-migrated-libraries\">What about applications using non-migrated libraries?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-dynamic-flag#what-about-applications-using-non-migrated-libraries\"><i class=\"material-icons\">link</i></a></h3>\n\n<p translation-result=\"on\">因为这只是一个什么也不做的代码清理工作，所以未迁移的库也同样可以工作。</p><p translation-origin=\"off\">Because this is a code cleanup that is a noop, non-migrated libraries will work the same either way.</p>\n\n\n  \n</div>\n\n\n<!-- links to this doc:\n-->\n<!-- links from this doc:\n - api/animations/query\n - api/common/NgForOf\n - api/common/NgIf\n - api/core/ContentChild\n - api/core/ContentChildren\n - api/core/ElementRef\n - api/core/ViewChild\n - api/core/ViewChildren\n - api/upgrade/static\n - guide/migration-dynamic-flag#dynamic-queries-flag-migration\n - guide/migration-dynamic-flag#what-about-applications-using-non-migrated-libraries\n - guide/migration-dynamic-flag#what-does-this-mean-for-libraries\n - guide/migration-dynamic-flag#what-does-this-migration-do\n - guide/migration-dynamic-flag#what-is-the-difference-between-static-and-dynamic-queries\n - guide/migration-dynamic-flag#why-is-this-migration-necessary\n - guide/static-query-migration\n - guide/static-query-migration#how-do-i-choose-which-static-flag-value-to-use-true-or-false\n - guide/static-query-migration#is-there-a-case-where-i-should-use-static-true\n - guide/static-query-migration#what-does-this-flag-mean\n - https://github.com/angular/angular-cn/edit/aio/aio/content/guide/migration-dynamic-flag.md?message=docs%3A%20请简述你的修改...\n-->"
}