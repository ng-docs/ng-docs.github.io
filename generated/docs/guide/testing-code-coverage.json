{"id":"guide/testing-code-coverage","title":"Find out how much code you're testing","contents":"\n\n\n<div class=\"github-links\">\n  <a href=\"https://github.com/angular/angular-cn/edit/cn/aio/content/guide/testing-code-coverage.md?message=docs%3A%20请简述你的修改...\" aria-label=\"提供编辑建议\" title=\"提供编辑建议\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n</div>\n\n\n<div class=\"content\">\n  <p><a id=\"code-coverage\"></a></p>\n<h1 id=\"find-out-how-much-code-youre-testing\" translation-result=\"on\">找出你要测试多少代码<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing-code-coverage#find-out-how-much-code-youre-testing\"><i class=\"material-icons\">link</i></a></h1><h1 translation-origin=\"off\">Find out how much code you're testing<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing-code-coverage#find-out-how-much-code-youre-testing\"><i class=\"material-icons\">link</i></a></h1>\n\n<p translation-result=\"on\">CLI 可以运行单元测试并创建代码覆盖率报告。代码覆盖率报告会向你展示代码库中可能无法通过单元测试进行正确测试的任意部位。</p><p translation-origin=\"off\">The CLI can run unit tests and create code coverage reports.\nCode coverage reports show you any parts of your code base that might not be properly tested by your unit tests.</p>\n\n<div class=\"alert is-helpful\">\n<p translation-result=\"on\">  如果你要试验本指南中所讲的应用，请<live-example name=\"testing\" nodownload=\"\">在浏览器中运行它</live-example>或<live-example name=\"testing\" downloadonly=\"\">下载并在本地运行它</live-example>。</p><p translation-origin=\"off\">If you'd like to experiment with the application that this guide describes, <live-example name=\"testing\" nodownload=\"\">run it in your browser</live-example> or <live-example name=\"testing\" downloadonly=\"\">download and run it locally</live-example>.</p>\n\n</div>\n<p translation-result=\"on\">要生成覆盖率报告，请在项目的根目录下运行以下命令。</p><p translation-origin=\"off\">To generate a coverage report run the following command in the root of your project.</p>\n\n<code-example format=\"shell\" language=\"shell\">\n\nng test --no-watch --code-coverage\n\n</code-example>\n<p translation-result=\"on\">测试完成后，该命令会在项目中创建一个 <code>/coverage</code> 目录。打开 <code>index.html</code> 文件，可以查看带有源代码和代码覆盖率值的报表。</p><p translation-origin=\"off\">When the tests are complete, the command creates a new <code>/coverage</code> folder in the project.\nOpen the <code>index.html</code> file to see a report with your source code and code coverage values.</p>\n\n<p translation-result=\"on\">如果要在每次测试时都创建代码覆盖率报告，可以在 CLI 配置文件 <code>angular.json</code> 中设置以下选项：</p><p translation-origin=\"off\">If you want to create code-coverage reports every time you test, set the following option in the CLI configuration file, <code>angular.json</code>:</p>\n\n<code-example format=\"json\" language=\"json\">\n\n\"test\": {\n  \"options\": {\n    \"codeCoverage\": true\n  }\n}\n\n</code-example>\n<h2 id=\"code-coverage-enforcement\" translation-result=\"on\">代码覆盖的实施<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing-code-coverage#code-coverage-enforcement\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\">Code coverage enforcement<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing-code-coverage#code-coverage-enforcement\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">代码覆盖率可以让你估算出你的代码测试了多少。如果你的团队确定要设置单元测试的最小覆盖率，可以使用 Angular CLI 来强制实施这个最低要求。</p><p translation-origin=\"off\">The code coverage percentages let you estimate how much of your code is tested.\nIf your team decides on a set minimum amount to be unit tested, enforce this minimum with the Angular CLI.</p>\n\n<p translation-result=\"on\">比如，假设你希望代码库的代码覆盖率至少达到 80％。要启用此功能，请打开 <a href=\"https://karma-runner.github.io\">Karma</a> 测试平台的配置文件 <code>karma.conf.js</code>，并在 <code>coverageReporter:</code> 键下添加 <code>check</code> 属性。</p><p translation-origin=\"off\">For example, suppose you want the code base to have a minimum of 80% code coverage.\nTo enable this, open the <a href=\"https://karma-runner.github.io\">Karma</a> test platform configuration file, <code>karma.conf.js</code>, and add the <code>check</code> property in the <code>coverageReporter:</code> key.</p>\n\n<code-example format=\"javascript\" language=\"javascript\">\n\ncoverageReporter: {\n  dir: require('path').join(__dirname, './coverage/&lt;project-name&gt;'),\n  subdir: '.',\n  reporters: [\n    { type: 'html' },\n    { type: 'text-summary' }\n  ],\n  check: {\n    <a href=\"api/core/global\" class=\"code-anchor\">global</a>: {\n      statements: 80,\n      branches: 80,\n      functions: 80,\n      lines: 80\n    }\n  }\n}\n\n</code-example>\n<p translation-result=\"on\"><code>check</code> 属性会让该工具在项目中运行单元测试时强制要求至少 80％的代码覆盖率。</p><p translation-origin=\"off\">The <code>check</code> property causes the tool to enforce a minimum of 80% code coverage when the unit tests are run in the project.</p>\n\n<p translation-result=\"on\">可以在<a href=\"https://github.com/karma-runner/karma-coverage/blob/master/docs/configuration.md\">此处</a>找到关于其它覆盖率配置项的更多信息。</p><p translation-origin=\"off\">Find more information about the different coverage configuration options <a href=\"https://github.com/karma-runner/karma-coverage/blob/master/docs/configuration.md\">here</a>.</p>\n\n<!-- links -->\n<!-- external links -->\n<!-- end links -->\n\n  <div class=\"reviewed\">最后复查时间： 2/28/2022</div>\n</div>\n\n\n<!-- links to this doc:\n - guide/testing\n-->\n<!-- links from this doc:\n - api/core/global\n - guide/testing-code-coverage#code-coverage-enforcement\n - guide/testing-code-coverage#find-out-how-much-code-youre-testing\n - guide/testing-code-coverage#代码覆盖的实施\n - guide/testing-code-coverage#找出你要测试多少代码\n - https://github.com/angular/angular-cn/edit/cn/aio/content/guide/testing-code-coverage.md?message=docs%3A%20请简述你的修改...\n - https://github.com/karma-runner/karma-coverage/blob/master/docs/configuration.md\n - https://karma-runner.github.io\n-->"}